apply from: "$rootDir/gradle/osgi.gradle"
apply plugin: 'com.moowork.node'

dependencies {
    include project( ":lib:lib-mustache" )
    include project( ":lib:lib-portal" )
    include project( ":lib:lib-admin" )
}

node {
    download = true
    version = '6.9.2'
}

bundle {
    instruction 'Bundle-Name', 'Admin Applications App'
    instruction 'X-Bundle-Type', 'system'
    instruction 'Include-Resource', "assets/app=${buildDir}/app"
}

task webpack( type: NpmTask, dependsOn: npmInstall ) {
    description = 'Build UI resources (ts, css, etc).'
    inputs.dir 'src/main'
    outputs.dir "${buildDir}/app"
    args = ['run', 'build']
}

task cleanNode(type: Delete) {
    delete 'node_modules'
}

jar.dependsOn += webpack
