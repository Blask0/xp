apply from: "$rootDir/gradle/admin-app.gradle"

dependencies {
    include project( ":lib:lib-admin" )
    include project( ":lib:lib-mustache" )
    include project( ":lib:lib-portal" )
}

ext {
    resourcesDir = file( 'src/main/resources' )
    buildResourcesDir = file( "${buildDir}/resources/main" )
}

bundle {
    instruction 'Bundle-Name', 'Admin Content Studio App'
    instruction 'X-Bundle-Type', 'system'
    instruction 'X-Source-Paths', "$resourcesDir, $buildResourcesDir"
}

task webpack( type: NodeTask, dependsOn: npmInstall ) {
    description = 'Build UI resources (ts, css, etc).'
    script = file( './node_modules/webpack/bin/webpack' )
    args = ['--config', "./webpack.config.js"]
    inputs.dir 'src/main/resources'
    outputs.dir 'build/resources/main'
}

jar.dependsOn += webpack
jar.outputs.dir "${buildDir}/resources/main"
