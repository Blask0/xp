<!DOCTYPE HTML>
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <title>ImageCanvas test page</title>
    <link rel="stylesheet" type="text/css" href="../../../../../../admin/common/styles/_all.css">

    <style>

        .display-area {
            width: 800px;
            height: 700px;
            background: #F1F1F1;
            margin: 10px auto;
            position: relative;
            overflow: auto;
        }

        img {
            border: 1px solid lightgrey;
            position: absolute;
            box-sizing: border-box;
        }

        .settings-area {
            width: 800px;
            margin: 10px auto;
        }

        .settings-area:after {
            content: '';
            display: table;
            clear: both;
        }

        .display-area-settings {
            width: 50%;
            float: left;
        }

        .image-canvas-settings {
            width: 50%;
            float: right;
        }

        label, input, select {
            display: block;
        }

        h4 {
            margin: 0 0 10px;
        }

    </style>

</head>
<body>

<!-- Configuration -->
<script type="text/javascript">
    var CONFIG = {
        baseUri: '../../../..'
    };
</script>

<!-- include source files here... -->
<script type="text/javascript" src="../../../../../../admin/common/lib/_all.js"></script>
<script type="text/javascript" src="../../../../../../admin/common/js/_all.js"></script>

<!-- include spec files here... -->
<script type="text/javascript">

    var DivEl = api.dom.DivEl,
        InputEl = api.dom.InputEl,
        LabelEl = api.dom.LabelEl;

    // create markup
    ////////////////////////////////////////////

    var displayArea = new DivEl('display-area');
    api.dom.Body.get().appendChild(displayArea);

    var image = new api.dom.ImgEl();
    displayArea.appendChild(image);

    var imageCanvas = new api.ui.image.ImageCanvas(image);
    image.onLoaded(function () {
        imageCanvas = new api.ui.image.ImageCanvas(image);
    });

    var settingsArea = new DivEl('settings-area');
    api.dom.Body.get().appendChild(settingsArea);


    var displayAreaSettings = new DivEl('display-area-settings');
    settingsArea.appendChild(displayAreaSettings);

    var displayAreaHeader = new api.dom.H4El();
    displayAreaHeader.getEl().setInnerHtml('Display area settings');
    displayAreaSettings.appendChild(displayAreaHeader);

    var backgroundInput = new InputEl().setName('background-color').setId('background-color');
    displayAreaSettings.appendChild(new LabelEl('Background color', backgroundInput));
    displayAreaSettings.appendChild(backgroundInput);

    var imageSelect = new api.dom.SelectEl().setName('image-url').setId('image-url');
    displayAreaSettings.appendChild(new LabelEl('Image', imageSelect));
    displayAreaSettings.appendChild(imageSelect);

    imageSelect.appendChild(new api.dom.OptionEl('', ''));
    imageSelect.appendChild(new api.dom.OptionEl('320_170px.jpg', '320 × 170 pixels'));
    imageSelect.appendChild(new api.dom.OptionEl('1280_854px.jpg', '1,280 × 854 pixels'));
    imageSelect.appendChild(new api.dom.OptionEl('140_240px.jpg', '140 × 240 pixels'));
    imageSelect.appendChild(new api.dom.OptionEl('683_1024px.jpg', '683 × 1,024 pixels'));

    var positionLeftInput = new InputEl(null, 'number').setName('position-left').setId('position-left');
    displayAreaSettings.appendChild(new LabelEl('Position left', positionLeftInput));
    displayAreaSettings.appendChild(positionLeftInput);

    var positionTopInput = new InputEl(null, 'number').setName('position-top').setId('position-top');
    displayAreaSettings.appendChild(new LabelEl('Position top', positionTopInput));
    displayAreaSettings.appendChild(positionTopInput);


    var imageCanvasSettings = new DivEl('image-canvas-settings');
    settingsArea.appendChild(imageCanvasSettings);

    var imageCanvasHeader = new api.dom.H4El();
    imageCanvasHeader.getEl().setInnerHtml('Image settings');
    imageCanvasSettings.appendChild(imageCanvasHeader);

    var enableCanvasCheckbox = new InputEl(null, 'checkbox').setName('enable-canvas').setId('enable-canvas');
    imageCanvasSettings.appendChild(new LabelEl('Enable canvas', enableCanvasCheckbox));
    imageCanvasSettings.appendChild(enableCanvasCheckbox);

    var imageWidthInput = new InputEl(null, 'number').setName('image-width').setId('image-width');
    imageCanvasSettings.appendChild(new LabelEl('Image width', imageWidthInput));
    imageCanvasSettings.appendChild(imageWidthInput);

    var imageZoomInput = new InputEl(null, 'number').setName('image-zoom').setId('image-zoom');
    imageZoomInput.getEl().setAttribute('min', '100');
    imageCanvasSettings.appendChild(new LabelEl('Image zoom', imageZoomInput));
    imageCanvasSettings.appendChild(imageZoomInput);

    // setup listeners
    ////////////////////////////////////////////////////

    backgroundInput.onInput(function () {
        displayArea.getHTMLElement().style.backgroundColor = backgroundInput.getValue();
    });

    imageSelect.onChange(function () {
        image.setSrc(imageSelect.getValue());
    });

    positionLeftInput.onInput(function () {
        image.getEl().setLeftPx(positionLeftInput.getValue());
    });
    positionLeftInput.setValue(0);

    positionTopInput.onInput(function () {
        image.getEl().setTopPx(positionTopInput.getValue());
    });
    positionTopInput.setValue(0);


    enableCanvasCheckbox.onChange(function () {
        imageCanvas.setEnabled(enableCanvasCheckbox.getHTMLElement()["checked"]);
    });

    imageWidthInput.onInput(function () {
        imageCanvas.setWidth(imageWidthInput.getValue());
    });

    imageZoomInput.onInput(function () {
        imageCanvas.setZoom(Math.max(imageZoomInput.getValue(), 100));
    })


</script>




</body>
</html>
